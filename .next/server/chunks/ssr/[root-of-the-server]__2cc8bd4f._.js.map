{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/file-uploader.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRef, useState, type DragEvent, type ChangeEvent } from \"react\";\nimport { UploadCloud, FileText, X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface FileUploaderProps {\n  onFileSelect: (file: File | null) => void;\n  file: File | null;\n}\n\nexport default function FileUploader({ onFileSelect, file }: FileUploaderProps) {\n  const [isDragging, setIsDragging] = useState(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const handleDrag = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setIsDragging(true);\n    } else if (e.type === \"dragleave\") {\n      setIsDragging(false);\n    }\n  };\n\n  const handleDrop = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      onFileSelect(e.dataTransfer.files[0]);\n    }\n  };\n  \n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    e.preventDefault();\n    if (e.target.files && e.target.files[0]) {\n      onFileSelect(e.target.files[0]);\n    }\n  };\n\n  const onButtonClick = () => {\n    inputRef.current?.click();\n  };\n  \n  const onRemoveFile = () => {\n      onFileSelect(null);\n      if(inputRef.current) {\n        inputRef.current.value = \"\";\n      }\n  }\n\n  if (file) {\n    return (\n      <div className=\"flex items-center justify-between rounded-lg border bg-secondary/50 p-4 transition-all\">\n        <div className=\"flex items-center gap-3 overflow-hidden\">\n          <FileText className=\"h-6 w-6 shrink-0 text-primary\" />\n          <span className=\"truncate text-sm font-medium text-foreground\">{file.name}</span>\n        </div>\n        <button \n            onClick={onRemoveFile} \n            className=\"group rounded-full p-1 text-muted-foreground transition-colors hover:bg-destructive/10 hover:text-destructive\"\n            aria-label=\"Remove file\"\n        >\n          <X className=\"h-5 w-5\" />\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-border bg-background p-10 text-center transition-colors duration-300\",\n        isDragging ? \"border-primary bg-primary/10\" : \"hover:border-border/80 hover:bg-muted/50\"\n      )}\n      onDragEnter={handleDrag}\n      onDragLeave={handleDrag}\n      onDragOver={handleDrag}\n      onDrop={handleDrop}\n      onClick={onButtonClick}\n      role=\"button\"\n      aria-label=\"File upload zone\"\n    >\n      <input\n        ref={inputRef}\n        type=\"file\"\n        id=\"file-upload\"\n        className=\"hidden\"\n        onChange={handleChange}\n        accept=\".docx,.pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf\"\n      />\n      <UploadCloud className=\"mb-4 h-12 w-12 text-muted-foreground transition-transform group-hover:scale-110\" />\n      <p className=\"font-semibold text-foreground\">Drag & drop your .docx or .pdf file</p>\n      <p className=\"text-sm text-muted-foreground\">or click to browse</p>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AAAA;AACA;AAJA;;;;;AAWe,SAAS,aAAa,EAAE,YAAY,EAAE,IAAI,EAAqB;IAC5E,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAoB;IAE1C,MAAM,aAAa,CAAC;QAClB,EAAE,cAAc;QAChB,EAAE,eAAe;QACjB,IAAI,EAAE,IAAI,KAAK,eAAe,EAAE,IAAI,KAAK,YAAY;YACnD,cAAc;QAChB,OAAO,IAAI,EAAE,IAAI,KAAK,aAAa;YACjC,cAAc;QAChB;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,EAAE,cAAc;QAChB,EAAE,eAAe;QACjB,cAAc;QACd,IAAI,EAAE,YAAY,CAAC,KAAK,IAAI,EAAE,YAAY,CAAC,KAAK,CAAC,EAAE,EAAE;YACnD,aAAa,EAAE,YAAY,CAAC,KAAK,CAAC,EAAE;QACtC;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,IAAI,EAAE,MAAM,CAAC,KAAK,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE;YACvC,aAAa,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;QAChC;IACF;IAEA,MAAM,gBAAgB;QACpB,SAAS,OAAO,EAAE;IACpB;IAEA,MAAM,eAAe;QACjB,aAAa;QACb,IAAG,SAAS,OAAO,EAAE;YACnB,SAAS,OAAO,CAAC,KAAK,GAAG;QAC3B;IACJ;IAEA,IAAI,MAAM;QACR,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,8MAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;sCACpB,8OAAC;4BAAK,WAAU;sCAAgD,KAAK,IAAI;;;;;;;;;;;;8BAE3E,8OAAC;oBACG,SAAS;oBACT,WAAU;oBACV,cAAW;8BAEb,cAAA,8OAAC,4LAAA,CAAA,IAAC;wBAAC,WAAU;;;;;;;;;;;;;;;;;IAIrB;IAEA,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iLACA,aAAa,iCAAiC;QAEhD,aAAa;QACb,aAAa;QACb,YAAY;QACZ,QAAQ;QACR,SAAS;QACT,MAAK;QACL,cAAW;;0BAEX,8OAAC;gBACC,KAAK;gBACL,MAAK;gBACL,IAAG;gBACH,WAAU;gBACV,UAAU;gBACV,QAAO;;;;;;0BAET,8OAAC,oNAAA,CAAA,cAAW;gBAAC,WAAU;;;;;;0BACvB,8OAAC;gBAAE,WAAU;0BAAgC;;;;;;0BAC7C,8OAAC;gBAAE,WAAU;0BAAgC;;;;;;;;;;;;AAGnD","debugId":null}},
    {"offset": {"line": 418, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/converter.ts"],"sourcesContent":["\n\"use client\";\n\nimport mammoth from 'mammoth';\nimport * as ExcelJS from 'exceljs';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.mjs`;\n\nexport type Question = {\n  questionText: string;\n  options: { [key: string]: string };\n  images: { data: string; in: 'question' | string }[];\n};\n\nconst PIXELS_TO_EMUS = 9525;\nconst DEFAULT_ROW_HEIGHT_IN_POINTS = 21.75;\nconst POINTS_TO_PIXELS = 4 / 3;\nconst IMAGE_MARGIN_PIXELS = 15;\n\n\nconst parseHtmlToQuestions = (html: string): Question[] => {\n    const questions: Question[] = [];\n    if (typeof window === 'undefined') return questions;\n\n    const container = document.createElement('div');\n    \n    let processedHtml = html.replace(/<sup>(.*?)<\\/sup>/g, (match, content) => {\n        const superscripts: { [key: string]: string } = { '0': '⁰', '1': '¹', '2': '²', '3': '³', '4': '⁴', '5': '⁵', '6': '⁶', '7': '⁷', '8': '⁸', '9': '⁹', '+': '⁺', '-': '⁻', '(': '⁽', ')': '⁾' };\n        return content.split('').map((char: string) => superscripts[char] || char).join('');\n    }).replace(/<sub>(.*?)<\\/sub>/g, (match, content) => {\n        const subscripts: { [key: string]: string } = { '0': '₀', '1': '₁', '2': '₂', '3': '₃', '4': '₄', '5': '₅', '6': '₆', '7': '₇', '8': '₈', '9': '₉', '+': '₊', '-': '₋' };\n        return content.split('').map((char: string) => subscripts[char] || char).join('');\n    });\n\n    container.innerHTML = processedHtml;\n\n    let currentQuestion: Question | null = null;\n    let lastOptionKey: string | null = null;\n\n    const finalizeQuestion = () => {\n        if (currentQuestion) {\n            questions.push(currentQuestion);\n            currentQuestion = null;\n            lastOptionKey = null;\n        }\n    };\n    \n    const elements = Array.from(container.children);\n\n    for (const el of elements) {\n        if (!(el instanceof HTMLElement)) continue;\n        \n        let textContent = el.textContent?.trim() || '';\n        const questionStartRegex = /^(?:Q|Question)?\\s*(\\d+)\\s*[.)]\\s*/;\n        const isNewQuestion = questionStartRegex.test(textContent);\n\n        if (isNewQuestion) {\n            finalizeQuestion();\n            const questionNumberMatch = textContent.match(questionStartRegex)!;\n            textContent = textContent.substring(questionNumberMatch[0].length).trim();\n\n            currentQuestion = { questionText: '', options: {}, images: [] };\n\n            const optionRegex = /\\(\\s*([A-Z])\\s*\\)|([A-Z])\\s*[.)]/g;\n            let lastIndex = 0;\n            let match;\n            let firstOptionIndex = -1;\n\n            while ((match = optionRegex.exec(textContent)) !== null) {\n                if (firstOptionIndex === -1) {\n                    firstOptionIndex = match.index;\n                    currentQuestion.questionText = textContent.substring(0, firstOptionIndex).trim();\n                }\n\n                if (lastIndex > 0) {\n                    const previousOptionLetter = optionRegex.exec(textContent.substring(0, lastIndex))?.[1] || optionRegex.exec(textContent.substring(0, lastIndex))?.[2];\n                    if (previousOptionLetter) {\n                        const optionText = textContent.substring(lastIndex, match.index).trim();\n                        currentQuestion.options[previousOptionLetter] = (currentQuestion.options[previousOptionLetter] || '') + optionText;\n                    }\n                }\n                const currentOptionLetter = match[1] || match[2];\n                lastIndex = match.index + match[0].length;\n                lastOptionKey = currentOptionLetter;\n            }\n             \n            if (firstOptionIndex !== -1) { // Options were found\n                if (lastOptionKey) {\n                    const lastOptionText = textContent.substring(lastIndex).trim();\n                    currentQuestion.options[lastOptionKey] = (currentQuestion.options[lastOptionKey] || '') + lastOptionText;\n                }\n            } else { // No options found on this line\n                currentQuestion.questionText = textContent;\n            }\n\n        } else if (currentQuestion) {\n            const optionRegex = /^\\s*(?:\\(\\s*([A-Z])\\s*\\)|([A-Z])\\s*[.)])/;\n            const match = textContent.match(optionRegex);\n\n            if (match) { // This line starts with an option\n                const optionLetter = match[1] || match[2];\n                lastOptionKey = optionLetter;\n                const optionText = textContent.substring(match[0].length).trim();\n                currentQuestion.options[optionLetter] = (currentQuestion.options[optionLetter] || '') + ' ' + optionText;\n                currentQuestion.options[optionLetter] = currentQuestion.options[optionLetter].trim();\n\n            } else { // This is a continuation of the previous part (question or last option)\n                 if (lastOptionKey) {\n                    currentQuestion.options[lastOptionKey] += ' ' + textContent;\n                    currentQuestion.options[lastOptionKey] = currentQuestion.options[lastOptionKey].trim();\n                 } else {\n                    currentQuestion.questionText += ' ' + textContent;\n                    currentQuestion.questionText = currentQuestion.questionText.trim();\n                 }\n            }\n        }\n        \n        // Image processing\n        if (currentQuestion) {\n            const tempDiv = document.createElement('div');\n            tempDiv.innerHTML = el.innerHTML;\n            Array.from(tempDiv.querySelectorAll('img')).forEach(img => {\n                const target = lastOptionKey ? `option${lastOptionKey}` : 'question';\n                currentQuestion!.images.push({ data: img.src, in: target });\n            });\n        }\n    }\n\n    finalizeQuestion();\n\n    // Final cleanup\n    return questions.map(q => {\n        q.questionText = q.questionText.replace(/[\\s\\u200B-\\u200D\\uFEFF]+/g, ' ').replace(/(\\d+)\\s*([°˚º])\\s*([CF]?)/gi, '$1$2$3').trim();\n        for (const key in q.options) {\n            q.options[key] = q.options[key].replace(/[\\s\\u200B-\\u200D\\uFEFF]+/g, ' ').replace(/(\\d+)\\s*([°˚º])\\s*([CF]?)/gi, '$1$2$3').trim();\n        }\n        return q;\n    });\n};\n\n\nconst getBase64Image = (imgSrc: string): { extension: 'png' | 'jpeg', data: string } => {\n    const extension = imgSrc.startsWith('data:image/jpeg') ? 'jpeg' : 'png';\n    const data = imgSrc.substring(imgSrc.indexOf(',') + 1);\n    return { extension, data };\n}\n\nconst getImageDimensions = (imgSrc: string): Promise<{ width: number; height: number }> => {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.onload = () => resolve({ width: img.width, height: img.height });\n        img.onerror = reject;\n        img.src = imgSrc;\n    });\n};\n\nconst formatTextForExcel = (text: string): string => {\n    return text.replace(/∞/g, 'Infinity');\n};\n\nexport const generateExcel = async (questions: Question[]): Promise<Blob> => {\n  if (questions.length === 0) {\n    throw new Error(\"No questions found. Check document format. Questions should be numbered (e.g., '1.') and options labeled (e.g., '(A)' or 'A.').\");\n  }\n\n  const workbook = new ExcelJS.Workbook();\n  const worksheet = workbook.addWorksheet('Questions');\n\n  worksheet.columns = [\n    { header: 'Sr. No', key: 'sr', width: 5.43 },\n    { header: 'Question content', key: 'question', width: 110.57 },\n    { header: 'Alternative1', key: 'alt1', width: 35.71 },\n    { header: 'Alternative2', key: 'alt2', width: 35.71 },\n    { header: 'Alternative3', key: 'alt3', width: 35.71 },\n    { header: 'Alternative4', key: 'alt4', width: 35.71 },\n  ];\n\n  const headerRow = worksheet.getRow(1);\n  headerRow.font = { name: 'Calibri', bold: true, size: 12, color: { argb: 'FFFFFFFF' } };\n  headerRow.alignment = { vertical: 'middle', horizontal: 'center' };\n  headerRow.fill = {\n    type: 'pattern',\n    pattern: 'solid',\n    fgColor: { argb: 'FF4F81BD' },\n  };\n  headerRow.height = 43.5;\n\n  for (const [index, q] of questions.entries()) {\n    const row = worksheet.addRow({\n      sr: index + 1,\n      question: formatTextForExcel(q.questionText),\n      alt1: formatTextForExcel(q.options['A'] || ''),\n      alt2: formatTextForExcel(q.options['B'] || ''),\n      alt3: formatTextForExcel(q.options['C'] || ''),\n      alt4: formatTextForExcel(q.options['D'] || ''),\n    });\n    \n    row.eachCell({ includeEmpty: true }, cell => {\n        cell.alignment = { vertical: 'top', horizontal: 'left', wrapText: true };\n        cell.font = { name: 'Calibri', size: 11 };\n    });\n    row.height = DEFAULT_ROW_HEIGHT_IN_POINTS;\n\n    let maxRowHeightInPoints = 0;\n    \n    const calculateCellHeightAndPlaceImages = async (cell: ExcelJS.Cell, text: string, images: {data: string, in: string}[]) => {\n        let textHeightInPixels = 0;\n        if (text) {\n          const lines = text.split('\\n');\n          const canvas = document.createElement(\"canvas\");\n          const context = canvas.getContext(\"2d\");\n          if(!context) return { totalHeight: 0 };\n          context.font = \"11pt Calibri\";\n          const column = worksheet.getColumn(cell.col);\n          const columnWidthInChars = column.width || 20; \n          const availableWidth = columnWidthInChars * 7.5;\n\n          let lineCount = 0;\n          lines.forEach(line => {\n             let currentLine = '';\n             const words = line.split(' ');\n             for(const word of words) {\n                if(context.measureText(currentLine + ' ' + word).width > availableWidth) {\n                  lineCount++;\n                  currentLine = word;\n                } else {\n                  currentLine += (currentLine ? ' ' : '') + word;\n                }\n             }\n             lineCount++;\n          });\n          textHeightInPixels = lineCount * 20;\n        }\n        \n        let cumulativeImageHeight = 0;\n\n        if (images.length > 0) {\n           for (const imgData of images) {\n              try {\n                  const { extension, data } = getBase64Image(imgData.data);\n                  const imageId = workbook.addImage({ base64: data, extension });\n                  const imageDims = await getImageDimensions(imgData.data);\n                  \n                  const imageWidthInPixels = 120;\n                  const imageHeightInPixels = (imageDims.height / imageDims.width) * imageWidthInPixels;\n                  \n                  const rowOffsetInPixels = textHeightInPixels + cumulativeImageHeight + IMAGE_MARGIN_PIXELS;\n                  cumulativeImageHeight += imageHeightInPixels + IMAGE_MARGIN_PIXELS;\n\n                  const column = worksheet.getColumn(cell.col);\n                  const cellWidthInPixels = column.width ? column.width * 7.5 : 100; \n                  const colOffsetInPixels = Math.max(0, (cellWidthInPixels - imageWidthInPixels) / 2);\n                  \n                  worksheet.addImage(imageId, {\n                    tl: { col: cell.col - 1, row: cell.row - 1 },\n                    ext: { width: imageWidthInPixels, height: imageHeightInPixels }\n                  });\n                  \n                  if ((worksheet as any).media && (worksheet as any).media.length > 0) {\n                    const lastImage = (worksheet as any).media[(worksheet as any).media.length - 1];\n                    if (lastImage && lastImage.range) {\n                      lastImage.range.tl.rowOff = rowOffsetInPixels * PIXELS_TO_EMUS;\n                      lastImage.range.tl.colOff = colOffsetInPixels * PIXELS_TO_EMUS;\n                    }\n                  }\n              } catch (e) { console.error(\"Could not add image\", e); }\n           }\n        }\n        \n        const totalCellHeightInPixels = textHeightInPixels + cumulativeImageHeight;\n        return { totalHeight: totalCellHeightInPixels / POINTS_TO_PIXELS };\n    };\n    \n    const questionImages = q.images.filter(img => img.in === 'question');\n    const { totalHeight: questionCellHeight } = await calculateCellHeightAndPlaceImages(row.getCell('question'), q.questionText, questionImages);\n    maxRowHeightInPoints = Math.max(maxRowHeightInPoints, questionCellHeight);\n\n    let maxOptionHeight = 0;\n    for (const [i, letter] of ['A', 'B', 'C', 'D'].entries()) {\n        const optionText = q.options[letter];\n        const optionImages = q.images.filter(img => img.in === `option${letter}`);\n        if(optionText === undefined && optionImages.length === 0) continue;\n\n        const cell = row.getCell(`alt${i+1}`);\n        const { totalHeight: optionCellHeight } = await calculateCellHeightAndPlaceImages(cell, optionText || '', optionImages);\n        maxOptionHeight = Math.max(maxOptionHeight, optionCellHeight);\n    }\n    maxRowHeightInPoints = Math.max(maxRowHeightInPoints, maxOptionHeight);\n\n    row.height = maxRowHeightInPoints > DEFAULT_ROW_HEIGHT_IN_POINTS ? maxRowHeightInPoints : DEFAULT_ROW_HEIGHT_IN_POINTS;\n  }\n  \n  worksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {\n    row.eachCell({ includeEmpty: true }, function(cell, colNumber) {\n      cell.border = {\n        top: { style: 'thin' },\n        left: { style: 'thin' },\n        bottom: { style: 'thin' },\n        right: { style: 'thin' },\n      };\n    });\n  });\n\n  const buffer = await workbook.xlsx.writeBuffer();\n  return new Blob([buffer], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" });\n};\n\nexport const parseFile = async (file: File): Promise<Question[]> => {\n    let htmlContent = '';\n    if (file.type === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\") {\n        const arrayBuffer = await file.arrayBuffer();\n        const { value } = await mammoth.convertToHtml({ arrayBuffer });\n        htmlContent = value;\n    } else if (file.type === \"application/pdf\") {\n        const arrayBuffer = await file.arrayBuffer();\n        const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;\n        \n        let combinedHtml = '';\n        for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {\n            const page = await pdf.getPage(pageNum);\n            const textContent = await page.getTextContent();\n            const viewport = page.getViewport({ scale: 1.5 });\n            const ops = await page.getOperatorList();\n            \n            const imagePromises: Promise<{ data: string, y: number, x: number } | null>[] = [];\n\n            for (let i = 0; i < ops.fnArray.length; i++) {\n                if (ops.fnArray[i] === pdfjsLib.OPS.paintImageXObject) {\n                    const imgKey = ops.argsArray[i][0];\n                    const promise = page.objs.get(imgKey).then((img: any) => {\n                        if (!img) return null;\n\n                        const transform = page.transform(viewport.transform, ops.transformMatrix);\n                        const y = transform[5];\n                        const x = transform[4];\n\n                        const canvas = document.createElement('canvas');\n                        canvas.width = img.width;\n                        canvas.height = img.height;\n                        const ctx = canvas.getContext('2d');\n                        if (ctx) {\n                            const imgData = ctx.createImageData(img.width, img.height);\n                            let data = img.data;\n                            if (img.kind === pdfjsLib.ImageKind.GRAYSCALE_1BPP) {\n                                const black = 0, white = 255;\n                                const dataBytes = (img.width + 7) >> 3;\n                                data = new Uint8ClampedArray(img.width * img.height * 4);\n                                let k = 0;\n                                for (let j = 0; j < img.height; j++) {\n                                    for (let bit = 0; bit < img.width; bit++) {\n                                        const val = (img.data[(j * dataBytes) + (bit >> 3)] >> (7 - (bit & 7))) & 1 ? black : white;\n                                        data[k++] = val; data[k++] = val; data[k++] = val; data[k++] = 255;\n                                    }\n                                }\n                            } else if (img.data.length === img.width * img.height * 3) { // RGB\n                                const rgba = new Uint8ClampedArray(img.width * img.height * 4);\n                                for (let j = 0, k = 0; j < img.data.length; j += 3, k += 4) {\n                                    rgba[k] = img.data[j];\n                                    rgba[k + 1] = img.data[j + 1];\n                                    rgba[k + 2] = img.data[j + 2];\n                                    rgba[k + 3] = 255;\n                                }\n                                data = rgba;\n                            }\n                            imgData.data.set(data);\n                            ctx.putImageData(imgData, 0, 0);\n                            return { data: canvas.toDataURL(), y, x };\n                        }\n                        return null;\n                    }).catch(e => {\n                        console.error(\"Error processing PDF image\", e);\n                        return null;\n                    });\n                    if (promise) imagePromises.push(promise);\n                }\n            }\n            const images = (await Promise.all(imagePromises)).filter((img): img is { data: string; y: number; x: number; } => img !== null);\n\n            let pageItems: { str: string, y: number, x: number }[] = textContent.items.map(item => ({\n                str: 'str' in item ? item.str : '',\n                y: 'transform' in item ? item.transform[5] : 0,\n                x: 'transform' in item ? item.transform[4] : 0,\n            }));\n\n            images.forEach(img => {\n                pageItems.push({str: `<img src=\"${img.data}\" />`, y: img.y, x: img.x});\n            });\n            \n            pageItems.sort((a, b) => {\n                if (Math.abs(b.y - a.y) < 5) { // Threshold to consider items on the same line\n                    return a.x - b.x;\n                }\n                return b.y - a.y; // Sort by vertical position (top to bottom)\n            });\n            \n            let currentLine = '';\n            let lastY = pageItems.length > 0 ? pageItems[0].y : null;\n\n            for (const item of pageItems) {\n                if (item.y !== null && lastY !== null && Math.abs(item.y - lastY) > 10) {\n                    if (currentLine.trim()) combinedHtml += `<p>${currentLine.trim()}</p>`;\n                    currentLine = '';\n                }\n                currentLine += item.str.includes('<img') ? item.str : ` ${item.str} `;\n                lastY = item.y;\n            }\n            if (currentLine.trim()) combinedHtml += `<p>${currentLine.trim()}</p>`;\n        }\n        htmlContent = combinedHtml;\n    } else {\n        throw new Error(\"Unsupported file type\");\n    }\n    \n    return parseHtmlToQuestions(htmlContent);\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 793, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { useState } from \"react\";\nimport { Loader2, Download, CheckCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport FileUploader from \"@/components/file-uploader\";\nimport { parseFile, generateExcel } from \"@/lib/converter\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { saveAs } from 'file-saver';\n\nexport default function Home() {\n  const [file, setFile] = useState<File | null>(null);\n  const [isDownloading, setIsDownloading] = useState(false);\n  const { toast } = useToast();\n\n  const handleFileSelect = (selectedFile: File | null) => {\n    if (selectedFile) {\n        const allowedTypes = [\n            \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n            \"application/pdf\"\n        ];\n        if (!allowedTypes.includes(selectedFile.type)) {\n            toast({\n                variant: \"destructive\",\n                title: \"Invalid File Type\",\n                description: \"Please upload a valid .docx or .pdf file.\",\n            });\n            setFile(null);\n            return;\n        }\n    }\n    setFile(selectedFile);\n  };\n\n  const handleDownload = async () => {\n    if (!file) {\n      toast({\n        variant: \"destructive\",\n        title: \"No file selected\",\n        description: \"Please upload a file first.\",\n      });\n      return;\n    }\n    \n    setIsDownloading(true);\n    \n    try {\n      const parsedQuestions = await parseFile(file);\n\n      if (!parsedQuestions || parsedQuestions.length === 0) {\n        toast({\n          variant: \"destructive\",\n          title: \"Parsing Failed\",\n          description: \"No questions could be extracted. Please check if the document is formatted correctly (e.g., questions numbered '1.', options labeled '(A)').\",\n        });\n        setIsDownloading(false);\n        return;\n      }\n      \n      const excelBlob = await generateExcel(parsedQuestions);\n      saveAs(excelBlob, `${file.name.replace(/\\.(docx|pdf)$/, '') || 'download'}.xlsx`);\n      \n      toast({\n        title: \"Download Successful!\",\n        description: \"Your Excel file has been downloaded.\",\n        action: <CheckCircle className=\"text-green-500\" />,\n      });\n\n    } catch (error) {\n      console.error(error);\n      const errorMessage = error instanceof Error ? error.message : \"An unknown error occurred.\";\n      toast({\n          variant: \"destructive\",\n          title: \"Operation Failed\",\n          description: errorMessage,\n      });\n    } finally {\n        setIsDownloading(false);\n    }\n  };\n  \n  const FileUpIcon = () => (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"h-8 w-8 text-primary\">\n      <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/>\n      <polyline points=\"17 8 12 3 7 8\"/>\n      <line x1=\"12\" x2=\"12\" y1=\"3\" y2=\"15\"/>\n    </svg>\n  );\n\n  return (\n    <div className=\"flex min-h-screen w-full flex-col items-center bg-background px-4 py-8\">\n      <div className=\"absolute top-0 left-0 w-full h-full bg-primary/10 -z-10 [mask-image:radial-gradient(ellipse_at_center,white_20%,transparent_70%)]\"></div>\n      <main className=\"w-full max-w-4xl\">\n        <Card className=\"shadow-xl ring-1 ring-black/5\">\n          <CardHeader className=\"items-center text-center\">\n             <div className=\"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10 mb-4\">\n                <FileUpIcon />\n            </div>\n            <CardTitle className=\"font-headline text-2xl\">\n              DocX/PDF to Excel Converter\n            </CardTitle>\n            <CardDescription>\n              Upload your quiz and download the structured Excel sheet.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <FileUploader onFileSelect={handleFileSelect} file={file} />\n          </CardContent>\n          {file && (\n             <CardFooter className=\"flex-col sm:flex-row gap-4\">\n                <Button\n                    className=\"w-full font-bold text-lg py-6\"\n                    size=\"lg\"\n                    onClick={handleDownload}\n                    disabled={isDownloading}\n                >\n                   {isDownloading ? (\n                        <>\n                            <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                            Processing...\n                        </>\n                    ) : (\n                        <>\n                            <Download className=\"mr-2 h-5 w-5\" />\n                            Download Excel File\n                        </>\n                    )}\n                </Button>\n            </CardFooter>\n          )}\n        </Card>\n\n        <footer className=\"mt-8 text-center text-sm text-muted-foreground\">\n            <p className=\"font-semibold\">100% Private and Secure</p>\n            <p>All processing happens locally in your browser. No data is ever uploaded to a server.</p>\n        </footer>\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}